<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mahad Alzaytun - Sistem Izin Keluar Sekolah</title>
    <link rel="stylesheet" href="izin keluar sekolah.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="logo-container">
                    <div class="logo-icon">
                        <i class="fas fa-school"></i>
                    </div>
                    <div class="logo-text">
                        <h2>Mahad Alzaytun</h2>
                        <p>Sistem Surat Izin Keluar Sekolah</p>
                    </div>
                </div>
            </div>
            <div class="login-body">
                <div class="role-selector">
                    <div class="role-option active" id="roleStudent">
                        <i class="fas fa-user-graduate"></i> Siswa
                    </div>
                    <div class="role-option" id="roleTeacher">
                        <i class="fas fa-chalkboard-teacher"></i> Guru
                    </div>
                </div>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username"><i class="fas fa-user"></i> Username</label>
                        <input type="text" id="username" class="form-control" value="mahad alzaytun" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password"><i class="fas fa-lock"></i> Password</label>
                        <input type="password" id="password" class="form-control" required>
                    </div>
                    
                    <button type="submit" class="btn" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i> Masuk
                    </button>
                </form>
                
                <div id="loginError" style="color: var(--danger); margin-top: 15px; text-align: center; display: none;">
                    <i class="fas fa-exclamation-circle"></i> Username atau password salah!
                </div>
            </div>
        </div>
    </div>
    
    <!-- Student Dashboard -->
    <div id="studentDashboard" class="container" style="display: none;">
        <div class="dashboard-header">
            <div class="logo-container header-logo">
                <div class="logo-icon">
                    <i class="fas fa-school"></i>
                </div>
                <div class="logo-text">
                    <h2>Mahad Alzaytun</h2>
                    <p>Sistem Izin Keluar Sekolah - Siswa</p>
                </div>
            </div>
            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-user-graduate"></i>
                </div>
                <div>
                    <div style="font-weight: 600; margin-bottom: 5px;" id="studentGreeting">Siswa</div>
                    <button id="logoutStudent" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Keluar
                    </button>
                </div>
            </div>
        </div>
        
        <div class="dashboard-nav">
            <a href="#" class="nav-item active" data-page="studentForm">
                <i class="fas fa-file-alt"></i> Form Izin
            </a>
            <a href="#" class="nav-item" data-page="studentHistory">
                <i class="fas fa-history"></i> Riwayat Izin
            </a>
        </div>
        
        <div class="dashboard-content">
            <!-- Form Izin Siswa -->
            <div id="studentForm" class="page-content">
                <div class="welcome-message">
                    <h4><i class="fas fa-hand-paper"></i> Formulir Permohonan Izin</h4>
                    <p>Isi formulir di bawah ini untuk mengajukan izin keluar sekolah. Pastikan data yang diisi benar dan lengkap.</p>
                </div>
                
                <div id="successMessage" class="success-message" style="display: none;">
                    <i class="fas fa-check-circle"></i>
                    <div>
                        <strong>Permohonan izin berhasil dikirim!</strong> 
                        <div style="font-size: 14px;">Lihat status permohonan di menu <strong>Riwayat Izin</strong></div>
                    </div>
                </div>
                
                <form id="permissionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="studentName"><i class="fas fa-user"></i> Nama Lengkap</label>
                            <input type="text" id="studentName" class="form-control" required placeholder="Masukkan nama lengkap">
                        </div>
                        
                        <div class="form-group">
                            <label for="studentClass"><i class="fas fa-users"></i> Kelas</label>
                            <select id="studentClass" class="form-control" required>
                                <option value="">Pilih Kelas</option>
                                <option value="X IPA 1">X IPA 1</option>
                                <option value="X IPA 2">X IPA 2</option>
                                <option value="X IPS 1">X IPS 1</option>
                                <option value="XI IPA 1">XI IPA 1</option>
                                <option value="XI IPA 2">XI IPA 2</option>
                                <option value="XII IPA 1">XII IPA 1</option>
                                <option value="XII IPA 2">XII IPA 2</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="permissionDate"><i class="fas fa-calendar-alt"></i> Tanggal Izin</label>
                            <input type="date" id="permissionDate" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="lessonHour"><i class="fas fa-clock"></i> Jam Pelajaran Ke</label>
                            <select id="lessonHour" class="form-control" required>
                                <option value="">Pilih Jam</option>
                                <option value="1-2">Jam 1-2</option>
                                <option value="3-4">Jam 3-4</option>
                                <option value="5-6">Jam 5-6</option>
                                <option value="7-8">Jam 7-8</option>
                                <option value="9-10">Jam 9-10</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="permissionType"><i class="fas fa-file-signature"></i> Jenis Izin</label>
                            <select id="permissionType" class="form-control" required>
                                <option value="">Pilih Jenis Izin</option>
                                <option value="Pulang">Pulang</option>
                                <option value="Keperluan Keluarga">Keperluan Keluarga</option>
                                <option value="Keperluan Kesehatan">Keperluan Kesehatan</option>
                                <option value="Keperluan Lainnya">Keperluan Lainnya</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="permissionReason"><i class="fas fa-comment-dots"></i> Alasan Izin (Detail)</label>
                        <textarea id="permissionReason" class="form-control" rows="4" required placeholder="Jelaskan alasan izin secara detail..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn">
                        <i class="fas fa-paper-plane"></i> Kirim Permohonan Izin
                    </button>
                </form>
            </div>
            
            <!-- Riwayat Izin Siswa - SEMUA RIWAYAT -->
            <div id="studentHistory" class="page-content" style="display: none;">
                <h3 class="page-title">
                    <i class="fas fa-history"></i> Riwayat Permohonan Izin
                </h3>
                
                <div id="historyInfo" style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px;">
                    <i class="fas fa-info-circle" style="color: var(--primary); margin-right: 10px;"></i>
                    <span>Menampilkan <strong>semua riwayat izin</strong> siswa di sekolah. Gunakan filter untuk melihat data tertentu.</span>
                </div>
                
                <!-- Filter Controls -->
                <div class="filter-controls">
                    <label>Filter:</label>
                    <button class="filter-btn active" data-filter="all">Semua Izin</button>
                    <button class="filter-btn" data-filter="my">Izin Saya</button>
                    <button class="filter-btn" data-filter="pending">Status Diproses</button>
                    <button class="filter-btn" data-filter="approved">Status Disetujui</button>
                    <button class="filter-btn" data-filter="rejected">Status Ditolak</button>
                    
                    <div style="margin-left: auto;">
                        <label for="historyDateFilter">Filter Tanggal:</label>
                        <input type="date" id="historyDateFilter" class="form-control" style="width: auto; display: inline-block;">
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="studentPermissionTable">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama Siswa</th>
                                <th>Kelas</th>
                                <th>Tanggal</th>
                                <th>Jam</th>
                                <th>Jenis Izin</th>
                                <th>Alasan</th>
                                <th>Status</th>
                                <th>Guru Penerima</th>
                            </tr>
                        </thead>
                        <tbody id="studentPermissionTableBody">
                            <!-- Data akan dimuat via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div id="emptyHistory" class="empty-state" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <h3>Belum ada riwayat izin</h3>
                    <p>Tidak ada data izin yang sesuai dengan filter yang dipilih.</p>
                    <button id="goToFormBtn" class="btn" style="width: auto; margin-top: 20px;">
                        <i class="fas fa-file-alt"></i> Ajukan Izin Sekarang
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Teacher Dashboard -->
    <div id="teacherDashboard" class="container" style="display: none;">
        <div class="dashboard-header">
            <div class="logo-container header-logo">
                <div class="logo-icon">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <div class="logo-text">
                    <h2>Mahad Alzaytun</h2>
                    <p>Sistem Izin Keluar Sekolah - Guru</p>
                </div>
            </div>
            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-user-tie"></i>
                </div>
                <div>
                    <div style="font-weight: 600; margin-bottom: 5px;">Guru</div>
                    <button id="logoutTeacher" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Keluar
                    </button>
                </div>
            </div>
        </div>
        
        <div class="dashboard-nav">
            <a href="#" class="nav-item active" data-page="teacherDashboardPage">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </a>
            <a href="#" class="nav-item" data-page="teacherPermission">
                <i class="fas fa-file-alt"></i> Permohonan Izin
            </a>
            <a href="#" class="nav-item" data-page="teacherManageClass">
                <i class="fas fa-chalkboard"></i> Kelola Kelas
            </a>
            <a href="#" class="nav-item" data-page="teacherReport">
                <i class="fas fa-chart-bar"></i> Laporan
            </a>
        </div>
        
        <div class="dashboard-content">
            <!-- Dashboard Guru -->
            <div id="teacherDashboardPage" class="page-content">
                <div class="welcome-message">
                    <h4><i class="fas fa-chalkboard-teacher"></i> Selamat Datang, Guru</h4>
                    <p>Anda dapat mengelola permohonan izin siswa, mengatur kelas, dan melihat laporan di sistem ini.</p>
                </div>
                
                <div class="form-grid">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-clock"></i> Permohonan Pending
                        </div>
                        <div style="font-size: 36px; font-weight: 700; color: var(--warning); text-align: center;" id="pendingCount">0</div>
                        <p style="text-align: center; color: var(--gray);">Menunggu persetujuan</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-check-circle"></i> Izin Disetujui
                        </div>
                        <div style="font-size: 36px; font-weight: 700; color: var(--success); text-align: center;" id="approvedCount">0</div>
                        <p style="text-align: center; color: var(--gray);">Izin telah disetujui</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-times-circle"></i> Izin Ditolak
                        </div>
                        <div style="font-size: 36px; font-weight: 700; color: var(--danger); text-align: center;" id="rejectedCount">0</div>
                        <p style="text-align: center; color: var(--gray);">Izin telah ditolak</p>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h4 style="margin-bottom: 15px; color: var(--accent); display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-list"></i> Permohonan Terbaru
                    </h4>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nama</th>
                                    <th>Kelas</th>
                                    <th>Tanggal</th>
                                    <th>Jenis Izin</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recentRequests">
                                <!-- Data akan dimuat via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Permohonan Izin untuk Guru -->
            <div id="teacherPermission" class="page-content" style="display: none;">
                <h3 class="page-title">
                    <i class="fas fa-file-alt"></i> Permohonan Izin Siswa
                </h3>
                
                <div class="table-container">
                    <table id="teacherPermissionTable">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama</th>
                                <th>Kelas</th>
                                <th>Tanggal</th>
                                <th>Jam</th>
                                <th>Jenis Izin</th>
                                <th>Alasan</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="teacherPermissionTableBody">
                            <!-- Data akan dimuat via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div id="emptyPermission" class="empty-state" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <h3>Tidak ada permohonan izin</h3>
                    <p>Belum ada siswa yang mengajukan izin keluar sekolah.</p>
                </div>
            </div>
            
            <!-- Kelola Kelas - DIPERBAIKI -->
            <div id="teacherManageClass" class="page-content" style="display: none;">
                <h3 class="page-title">
                    <i class="fas fa-chalkboard"></i> Kelola Kelas
                </h3>
                
                <div class="card" style="margin-bottom: 30px;">
                    <div class="card-header">
                        <i class="fas fa-plus-circle"></i> Tambah Kelas Baru
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="className"><i class="fas fa-chalkboard"></i> Nama Kelas</label>
                            <input type="text" id="className" class="form-control" placeholder="Contoh: X IPA 1">
                        </div>
                        
                        <div class="form-group">
                            <label for="classTeacher"><i class="fas fa-user-tie"></i> Wali Kelas</label>
                            <input type="text" id="classTeacher" class="form-control" placeholder="Nama Wali Kelas">
                        </div>
                        
                        <div class="form-group">
                            <label for="classRoom"><i class="fas fa-door-open"></i> Ruangan</label>
                            <input type="text" id="classRoom" class="form-control" placeholder="Contoh: A-101">
                        </div>
                    </div>
                    <button id="addClassBtn" class="btn" style="width: auto;">
                        <i class="fas fa-plus"></i> Tambah Kelas
                    </button>
                </div>
                
                <!-- Form Edit Kelas (Sembunyikan Awalnya) -->
                <div id="editClassForm" class="edit-class-form" style="display: none;">
                    <h5><i class="fas fa-edit"></i> Edit Kelas</h5>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editClassName"><i class="fas fa-chalkboard"></i> Nama Kelas</label>
                            <input type="text" id="editClassName" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="editClassTeacher"><i class="fas fa-user-tie"></i> Wali Kelas</label>
                            <input type="text" id="editClassTeacher" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="editClassRoom"><i class="fas fa-door-open"></i> Ruangan</label>
                            <input type="text" id="editClassRoom" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="editClassStudents"><i class="fas fa-users"></i> Jumlah Siswa</label>
                            <input type="number" id="editClassStudents" class="form-control" min="0" max="50">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button id="saveEditClassBtn" class="btn btn-success" style="width: auto;">
                            <i class="fas fa-save"></i> Simpan Perubahan
                        </button>
                        <button id="cancelEditClassBtn" class="btn btn-danger" style="width: auto;">
                            <i class="fas fa-times"></i> Batal
                        </button>
                    </div>
                </div>
                
                <h4 style="margin-bottom: 15px; color: var(--accent); display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-list"></i> Daftar Kelas
                </h4>
                <div class="table-container">
                    <table id="classTable">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama Kelas</th>
                                <th>Wali Kelas</th>
                                <th>Ruangan</th>
                                <th>Jumlah Siswa</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="classTableBody">
                            <!-- Data akan dimuat via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Laporan -->
            <div id="teacherReport" class="page-content" style="display: none;">
                <h3 class="page-title">
                    <i class="fas fa-chart-bar"></i> Laporan Izin Siswa
                    <button class="excel-btn" id="exportExcelBtn">
                        <i class="fas fa-file-excel"></i> Export ke Excel
                    </button>
                </h3>
                
                <div style="margin-bottom: 20px; display: flex; align-items: center; flex-wrap: wrap; gap: 10px;">
                    <label for="reportDate" style="font-weight: 600; color: var(--accent);">
                        <i class="fas fa-filter"></i> Filter Tanggal:
                    </label>
                    <input type="date" id="reportDate" class="form-control" style="width: auto;">
                    <button id="filterReportBtn" class="btn" style="width: auto;">
                        <i class="fas fa-search"></i> Filter
                    </button>
                    <button id="resetReportBtn" class="btn" style="width: auto; background-color: var(--gray);">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                </div>
                
                <div class="table-container">
                    <table id="reportTable">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama</th>
                                <th>Kelas</th>
                                <th>Tanggal</th>
                                <th>Jam</th>
                                <th>Jenis Izin</th>
                                <th>Alasan</th>
                                <th>Status</th>
                                <th>Guru Penerima</th>
                            </tr>
                        </thead>
                        <tbody id="reportTableBody">
                            <!-- Data akan dimuat via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div id="emptyReport" class="empty-state" style="display: none;">
                    <i class="fas fa-chart-line"></i>
                    <h3>Tidak ada data laporan</h3>
                    <p>Tidak ada permohonan izin pada tanggal yang dipilih.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal untuk Guru yang Menerima -->
    <div id="teacherModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-user-check"></i> Konfirmasi Guru Penerima
                </div>
                <button class="close-modal" id="closeTeacherModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="teacherName"><i class="fas fa-signature"></i> Nama Guru Penerima</label>
                    <input type="text" id="teacherName" class="form-control" required placeholder="Masukkan nama lengkap">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button id="confirmTeacherBtn" class="btn btn-success">
                        <i class="fas fa-check"></i> Konfirmasi
                    </button>
                    <button id="cancelTeacherBtn" class="btn btn-danger">
                        <i class="fas fa-times"></i> Batal
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Struk Izin -->
    <div id="printModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-print"></i> Cetak Surat Izin
                </div>
                <button class="close-modal" id="closePrintModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="print-struk" id="printContent">
                    <div class="struk-header">
                        <div style="font-size: 18px; font-weight: bold;">MAHAD ALZAYTUN</div>
                        <div style="font-size: 14px; margin-top: 5px;">SURAT IZIN KELUAR SEKOLAH</div>
                        <div style="font-size: 10px; margin-top: 5px;">Jl. Pendidikan No. 123, Jakarta</div>
                    </div>
                    <div class="struk-body">
                        <div class="struk-row">
                            <span>Nama:</span>
                            <span id="printName">-</span>
                        </div>
                        <div class="struk-row">
                            <span>Kelas:</span>
                            <span id="printClass">-</span>
                        </div>
                        <div class="struk-row">
                            <span>Tanggal:</span>
                            <span id="printDate">-</span>
                        </div>
                        <div class="struk-row">
                            <span>Jam Pelajaran:</span>
                            <span id="printHour">-</span>
                        </div>
                        <div class="struk-row">
                            <span>Jenis Izin:</span>
                            <span id="printType">-</span>
                        </div>
                        <div class="struk-row">
                            <span>Alasan:</span>
                            <span id="printReason">-</span>
                        </div>
                        <div class="struk-row">
                            <span>Status:</span>
                            <span id="printStatus" style="font-weight: bold; color: green;">DISETUJUI</span>
                        </div>
                        <div class="struk-row">
                            <span>Disetujui oleh:</span>
                            <span id="printTeacher">-</span>
                        </div>
                    </div>
                    <div class="struk-footer">
                        <div style="margin-bottom: 10px;">Harap tunjukkan surat ini kepada satpam sekolah</div>
                        <div style="font-weight: bold;">Terima kasih</div>
                        <div style="font-size: 10px; margin-top: 10px;">TTD dan Stempel Sekolah</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button id="printBtn" class="btn btn-primary">
                        <i class="fas fa-print"></i> Cetak
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Konfirmasi Hapus -->
    <div id="deleteClassModal" class="modal">
        <div class="modal-content">
            <div class="confirm-dialog">
                <h4><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i> Konfirmasi Hapus Kelas</h4>
                <p>Apakah Anda yakin ingin menghapus kelas <strong id="deleteClassName">-</strong>?</p>
                <p style="font-size: 14px; color: var(--gray);">Data kelas yang dihapus tidak dapat dikembalikan.</p>
                <div class="confirm-dialog-buttons">
                    <button id="confirmDeleteClassBtn" class="btn btn-danger">
                        <i class="fas fa-trash"></i> Ya, Hapus
                    </button>
                    <button id="cancelDeleteClassBtn" class="btn">
                        <i class="fas fa-times"></i> Batal
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="izin keluar sekolah.js"></script>
</body>
</html>